<!DOCTYPE html><html><head><title>Coccinelle Semantic Patch Repository</title></head><body><center><h2>Coccinelle Semantic Patch Repository</h2></center><p>About Coccinelle: <a href=http://coccinelle.lip6.fr/>http://coccinelle.lip6.fr/</a><br>Mailing list: <a href=mailto:cocci@systeme.lip6.fr>cocci@systeme.lip6.fr</a> - <a href=https://systeme.lip6.fr/mailman/listinfo/cocci>https://systeme.lip6.fr/mailman/listinfo/cocci</a><p>
<A HREF=README.html>Short index</A><P>
<P>
<HR>
Target: Generic
<P>
<A HREF=arref/arref.cocci>arref/arref.cocci</A>  -  Adjust array index
<pre>
	
	Convert array index from the loop bound to the loop index.

</pre>
<A HREF=badand/badand.cocci>badand/badand.cocci</A>  -  Convert && to ||
<pre>
	
	The pattern !E && !E->fld is nonsensical.  The patch below updates this
	according to the assumption that && should be ||.  But perhaps another
	solution was intended.

</pre>
<A HREF=badkm2/badkm2.cocci>badkm2/badkm2.cocci</A>  -  Ensure a consistent return value in error case
<pre>
	
	Typically, the return value desired for the failure of a function with an
	integer return value is a negative integer.  In these cases, the return
	value is sometimes a negative integer and sometimes 0, due to a subsequent
	initialization of the return variable within the loop.

</pre>
<A HREF=bitcall/bitcall.cocci>bitcall/bitcall.cocci</A>  -  convert & to &&
<pre>
	
	The use of & to obtain a conjunction that evaluates both of its arguments
	seems unnecessarily tricky.

</pre>
<A HREF=da/da.cocci>da/da.cocci</A>  -  Correct double assignment
<pre>
	
	The double assignment is meant to be a bit-or to combine two values.

</pre>
<A HREF=devname/devname.cocci>devname/devname.cocci</A>  -  Eliminate NULL dereference
<pre>
	
	dev_name always dereferences its argument, so it should not be called if
	the argument is NULL.  The function indeed later tests the argument for
	being NULL.

</pre>
<A HREF=double_call/dc.cocci>double_call/dc.cocci</A>  -  Eliminate useless code
<pre>
	
	The variable client is initialized twice to the same (side effect-free)
	expression.  Drop one initialization.

</pre>
<A HREF=double_null/double_null.cocci>double_null/double_null.cocci</A>  -  Correct NULL test
<pre>
	
	Test the value that was just allocated rather than the previously tested one.

</pre>
<A HREF=doubleinit/doubleinit.cocci>doubleinit/doubleinit.cocci</A>  -  Remove duplicate structure field initialization
<pre>
	
	The definition of uml_netdev_ops has initializations of a local function
	and eth_mac_addr for its ndo_set_mac_address field.  This change uses only
	the local function.

</pre>
<A HREF=doubletest_high/doubletest_highconfidence.cocci>doubletest_high/doubletest_highconfidence.cocci</A>  -  Adjust double test
<pre>
	
	Rewrite a duplicated test to test the correct value

</pre>
<A HREF=drop_continue/cont.cocci>drop_continue/cont.cocci</A>  -  Drop unnecessary continue
<pre>
	
	Continue is not needed at the bottom of a loop.

</pre>
<A HREF=if-semicolon/if-semicolon.cocci>if-semicolon/if-semicolon.cocci</A>  -  Detect semicolon after if
<pre>
	
	Detect a semicolon after if(...) that is preventing the error check to
	work correctly. Removing this semicolon will change the code behavior,
	but this is intended.

</pre>
<A HREF=ifseqerr/ifseqerr.cocci>ifseqerr/ifseqerr.cocci</A>  -  Remove unnecessary error check
<pre>
	
	This code does not call deinit_card(card); in an error case, as done in
	other error-handling code in the same function.  But actually, the called
	function init_sram can only return 0, so there is no need for the error
	check at all.
	
	init_sram is also given a void return type, and its single return statement
	at the end of the function is dropped.

</pre>
<A HREF=isnullo/isnull.cocci>isnullo/isnull.cocci</A>  -  Keep pointer to resource so it can be freed
<pre>
	
	Add a new variable for storing resources accessed subsequent to the one
	accessed using request_mem_region, so the one accessed using
	request_mem_region can be released if needed.
	
	The resource variable names are also changed to be more descriptive.
	
	This code is also missing some calls to iounmap.

</pre>
<A HREF=kfree_after/kfree_after.cocci>kfree_after/kfree_after.cocci</A>  -  Adjust error handling code
<pre>
	
	Use the error handling code at the end of the function, rather than
	returning directly.

</pre>
<A HREF=mini_null3/mini_null_ref3.cocci>mini_null3/mini_null_ref3.cocci</A>  -  Move a dereference below a NULL test
<pre>
	
	If the NULL test is necessary, then the dereference should be moved below
	the NULL test.

</pre>
<A HREF=mini_null_ref_aug14/mini_null_ref.cocci>mini_null_ref_aug14/mini_null_ref.cocci</A>  -  Remove potential NULL dereferences
<pre>
	
	If the NULL test is necessary, the initialization involving a dereference of
	the tested value should be moved after the NULL test.

</pre>
<A HREF=notnull/notnull.cocci>notnull/notnull.cocci</A>  -  Remove redundant test
<pre>
	
	vpage is checked not to be NULL just after it is initialized at the
	beginning of each loop iteration.

</pre>
<A HREF=notnull/notnull2.cocci>notnull/notnull2.cocci</A>  -  Correct redundant test
<pre>
	
	str has already been tested.  It seems that this test should be on the
	recently returned value snr.

</pre>
<A HREF=semicolon/semicolon.cocci>semicolon/semicolon.cocci</A>  -  Remove unnecessary semicolon
<pre>
	
	Removes unnecessary semicolon

</pre>
<A HREF=signed/signed.cocci>signed/signed.cocci</A>  -  Use unsigned for loop index
<pre>
	
	A few more cases in the spirit of the patch \"Trivial: Replacement of always
	>0 ints with unsigned ints\" submitted by Ricardo Martins <ricardo@scarybox.net>

</pre>
<A HREF=sizeof/sizeof_sizeof.cocci>sizeof/sizeof_sizeof.cocci</A>  -  Eliminate double sizeof
<pre>
	
	Taking sizeof the result of sizeof is quite strange and does not seem to be
	what is wanted here.

</pre>
<A HREF=sz/sz.cocci>sz/sz.cocci</A>  -  Correct code taking the size of a pointer
<pre>
	
	sizeof(share_id) is just the size of the pointer.  On the other hand,
	block->share_id is an array, so its size seems more appropriate.

</pre>
<A HREF=sz3/sz3.cocci>sz3/sz3.cocci</A>  -  Take size of pointed value, not pointer
<pre>
	
	Sizeof a pointer-typed expression returns the size of the pointer, not that
	of the pointed data.

</pre>
<A HREF=unsf/unsf.cocci>unsf/unsf.cocci</A>  -  Fix return value from an unsigned function
<pre>
	
	The function has an unsigned return type, but returns a negative constant
	to indicate an error condition.  

</pre>
<A HREF=unsf/unsf_ret0.cocci>unsf/unsf_ret0.cocci</A>  -  Fix return value from an unsigned function
<pre>
	
	The function has an unsigned return type, but returns a negative constant
	to indicate an error condition.  Another error condition in the same
	function is indicated by returning 0, and indeed the only call to the
	function checks for 0 to detect errors, so the return of a negative value
	it converted to a return of 0.

</pre>
<A HREF=unused_err/unused_err.cocci>unused_err/unused_err.cocci</A>  -  Use available error codes
<pre>
	
	Error codes are stored in err, but the return value is always 0.  Return
	err instead.

</pre>
<A HREF=write2/write2.cocci>write2/write2.cocci</A>  -  delete double assignment
<pre>
	
	Delete successive assignments to the same location.

</pre>
<A HREF=xand/xand.cocci>xand/xand.cocci</A>  -  Detect duplicated test
<pre>
	
	Look for duplicate && and || tests.

</pre>
<P>
<HR>
Target: Linux
<P>
<A HREF=9p/category2a_p9_client_walk.cocci>9p/category2a_p9_client_walk.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, the function p9_client_walk returns an ERR pointer,
	but never returns a NULL pointer. So a NULL test that comes after an
	IS_ERR test should be deleted.

</pre>
<A HREF=9p/p9_client_walk.cocci>9p/p9_client_walk.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, the function p9_client_walk returns an ERR pointer,
	but never returns a NULL pointer. So a NULL test that comes after an
	IS_ERR test should be deleted.

</pre>
<A HREF=aaci/category2a_aaci_init_card.cocci>aaci/category2a_aaci_init_card.cocci</A>  -  Bad NULL test
<pre>
	
	In case of error, the function aaci_init_card returns an ERR pointer,
	but never returns a NULL pointer. We have noticed a bad NULL test,
	which comes after a call to this function. Rather than doing an IS_ERR
	test, we suggest to duplicate the label out: one label for the case
	where aaci_init_card returns a valid pointer, and another for the case
	where aaci_init_card returns an ERR pointer.

</pre>
<A HREF=acl/patch.cocci>acl/patch.cocci</A>  -  Add missing call to posix_acl_release
<pre>
	
	posix_acl_clone does a memory allocation and sets a reference count, so
	posix_acl_release is needed afterwards to free it.

</pre>
<A HREF=acpi/category2b_back_device_reg.cocci>acpi/category2b_back_device_reg.cocci</A>  -  Dereference without an error test
<pre>
	
	After a variable is assigned the result of backlight_device_register, an error
	test should be performed before a dereference. 

</pre>
<A HREF=acpid/acpi.cocci>acpid/acpi.cocci</A>  -  Drop uses of acpi_driver_data
<pre>
	
	Drop uses of acpi_driver_data

</pre>
<A HREF=after_netif/after_netif.cocci>after_netif/after_netif.cocci</A>  -  Fix use of skb after netif_rx
<pre>
	
	Recently, Wang Chen submitted a patch
	(d30f53aeb31d453a5230f526bea592af07944564) to move a call to netif_rx(skb)
	after a subsequent reference to skb, because netif_rx may call kfree_skb on
	its argument.  netif_rx_ni calls netif_rx, so the same problem occurs in
	the files below.
	
	I have left the updating of dev->last_rx after the calls to netif_rx_ni
	because it seems time dependent, but moved the other field updates before.

</pre>
<A HREF=after_netif/after_netif_modif.cocci>after_netif/after_netif_modif.cocci</A>  -  Fix use of skb after netif_rx
<pre>
	
	Recently, Wang Chen submitted a patch
	(d30f53aeb31d453a5230f526bea592af07944564) to move a call to netif_rx(skb)
	after a subsequent reference to skb, because netif_rx may call kfree_skb on
	its argument.  netif_rx_ni calls netif_rx, so the same problem occurs in
	the files below.
	
	I have left the updating of dev->last_rx after the calls to netif_rx_ni
	because it seems time dependent, but moved the other field updates before.

</pre>
<A HREF=alloc9/kmalloc9.cocci>alloc9/kmalloc9.cocci</A>  -  Eliminate memory leak
<pre>
	
	__ip_vs_service_get and __ip_vs_svc_fwm_get increment a reference count, so
	that reference count should be decremented before leaving the function in an
	error case.

</pre>
<A HREF=alloc_cast/alloc_cast.cocci>alloc_cast/alloc_cast.cocci</A>  -  Drop memory allocation cast
<pre>
	
	Drop cast on the result of kmalloc and similar functions.

</pre>
<A HREF=alloc_domain/easykmret.cocci>alloc_domain/easykmret.cocci</A>  -  Add missing free_domain_mem
<pre>
	
	Add missing free_domain_mem on failure path after alloc_domain.

</pre>
<A HREF=alloc_etherdev/alloc.cocci>alloc_etherdev/alloc.cocci</A>  -  Adjust error handling after call to alloc_etherdev()
<pre>
	
	Detect possible error handling code related to alloc_etherdev().

</pre>
<A HREF=alloc_tty/alloc_tty.cocci>alloc_tty/alloc_tty.cocci</A>  -  add missing put_tty_driver
<pre>
	
	alloc_tty_driver is called at the beginning of the function containing the
	lines of code shown in the patch.  Thus, put_tty_driver is needed before
	returning in the error handling code.

</pre>
<A HREF=allocs/a2.cocci>allocs/a2.cocci</A>  -  Add missing fput
<pre>
	
	fget increments a reference count, so fput is needed to decrement it.  I
	have added a goto to the end of the function where there was already such a
	call.

</pre>
<A HREF=arraysize/array.cocci>arraysize/array.cocci</A>  -  Use ARRAY_SIZE
<pre>
	
	ARRAY_SIZE is more concise to use when the size of an array is divided by
	the size of its type or the size of its first element.

</pre>
<A HREF=arref/arref.cocci>arref/arref.cocci</A>  -  Adjust array index
<pre>
	
	Convert array index from the loop bound to the loop index.

</pre>
<A HREF=asprintf/asprintf.cocci>asprintf/asprintf.cocci</A>  -  Use kasprintf
<pre>
	
	kasprintf combines kmalloc and sprintf, and takes care of the size
	calculation itself.

</pre>
<A HREF=atm/atm.cocci>atm/atm.cocci</A>  -  add missing atm_dev_put
<pre>
	
	The earlier call to atm_dev_lookup increases the reference count of dev,
	so decrease it on the way out.

</pre>
<A HREF=auth/auth.cocci>auth/auth.cocci</A>  -  Adjust error handling code involving auth_domain_put
<pre>
	
	Once clp is assigned, it never becomes NULL, so we can make a label for it
	in the error handling code.  Because the call to path_lookup follows the
	call to auth_domain_find, its error handling code should jump to this new
	label.

</pre>
<A HREF=badand/badand.cocci>badand/badand.cocci</A>  -  Convert && to ||
<pre>
	
	The pattern !E && !E->fld is nonsensical.  The patch below updates this
	according to the assumption that && should be ||.  But perhaps another
	solution was intended.

</pre>
<A HREF=badftest/badftest.cocci>badftest/badftest.cocci</A>  -  Correct NULL test
<pre>
	
	Test the just-allocated value for NULL rather than some other value.

</pre>
<A HREF=badkm/badkm.cocci>badkm/badkm.cocci</A>  -  Initialize return variable with error code
<pre>
	
	Typically, the return value desired for the failure of a memory allocation
	is -ENOMEM.  In this case, the return value is undesirably 0.

</pre>
<A HREF=badkm2/badkm2.cocci>badkm2/badkm2.cocci</A>  -  Ensure a consistent return value in error case
<pre>
	
	Typically, the return value desired for the failure of a function with an
	integer return value is a negative integer.  In these cases, the return
	value is sometimes a negative integer and sometimes 0, due to a subsequent
	initialization of the return variable within the loop.

</pre>
<A HREF=badktest/badktest.cocci>badktest/badktest.cocci</A>  -  Correct NULL test
<pre>
	
	Test the just-allocated value for NULL rather than some other value.

</pre>
<A HREF=badmsg/badmsg.cocci>badmsg/badmsg.cocci</A>  -  Return -ENOMEM on memory allocation failure
<pre>
	
	In this code, 0 is returned on memory allocation failure, even though other
	failures return -ENOMEM or other similar values.

</pre>
<A HREF=badmsg3/badmsg3.cocci>badmsg3/badmsg3.cocci</A>  -  Correct return value on error handling
<pre>
	
	Correct return value on error handling

</pre>
<A HREF=badty/badty.cocci>badty/badty.cocci</A>  -  Correct the size argument to kzalloc
<pre>
	
	obj has type struct snmp_object **, not struct snmp_object *.  But indeed
	it is not even clear why kmalloc is needed.  The memory is freed by the end
	of the function, so the local variable of pointer type should be sufficient.

</pre>
<A HREF=bitcall/bitcall.cocci>bitcall/bitcall.cocci</A>  -  convert & to &&
<pre>
	
	The use of & to obtain a conjunction that evaluates both of its arguments
	seems unnecessarily tricky.

</pre>
<A HREF=bits/notand.cocci>bits/notand.cocci</A>  -  Correct use of ! and &
<pre>
	
	In commit e6bafba5b4765a5a252f1b8d31cbf6d2459da337, a bug was fixed that
	involved converting !x & y to !(x & y).  The code below shows the same
	pattern, and thus should perhaps be fixed in the same way.
	
	This is not tested and clearly changes the semantics, so it is only
	something to consider.

</pre>
<A HREF=bits2/notand.cocci>bits2/notand.cocci</A>  -  Correct use of ! and &
<pre>
	
	Correct priority problem in the use of ! and &.

</pre>
<A HREF=block_nil/retsall.cocci>block_nil/retsall.cocci</A>  -  use BLOCK_NIL
<pre>
	
	Use BLOCK_NIL consistently rather than sometimes 0xffff and sometimes
	BLOCK_NIL.

</pre>
<A HREF=bo/bo.cocci>bo/bo.cocci</A>  -  use BUG_ON
<pre>
	
	Use BUG_ON(x) rather than if(x) BUG();

</pre>
<A HREF=bond/short_timeout.cocci>bond/short_timeout.cocci</A>  -  Adjust constant name
<pre>
	
	AD_SHORT_TIMEOUT and AD_STATE_LACP_ACTIVITY have the same value, but
	AD_STATE_LACP_ACTIVITY better reflects the intended semantics.

</pre>
<A HREF=bootmem/bootmem.cocci>bootmem/bootmem.cocci</A>  -  Eliminate NULL test and memset after alloc_bootmem
<pre>
	
	As noted by Akinobu Mita in patch b1fceac2b9e04d278316b2faddf276015fc06e3b,
	alloc_bootmem and related functions never return NULL and always return a
	zeroed region of memory.  Thus a NULL test or memset after calls to these
	functions is unnecessary.

</pre>
<A HREF=bootmem2/bootmem.cocci>bootmem2/bootmem.cocci</A>  -  Eliminate NULL test and memset after alloc_bootmem
<pre>
	
	As noted by Akinobu Mita in patch b1fceac2b9e04d278316b2faddf276015fc06e3b,
	alloc_bootmem and related functions never return NULL and always return a
	zeroed region of memory.  Thus a NULL test or memset after calls to these
	functions is unnecessary.

</pre>
<A HREF=bss/sp1094.cocci>bss/sp1094.cocci</A>  -  Add missing call to cfg80211_put_bss
<pre>
	
	A call to cfg80211_get_bss hould be accompanied by a call to
	cfg80211_put_bss in error-handling code.

</pre>
<A HREF=btrfs/btrfs.cocci>btrfs/btrfs.cocci</A>  -  Add missing btrfs_free_path
<pre>
	
	Btrfs_alloc_path should be matched with btrfs_free_path in error-handling code.

</pre>
<A HREF=bugon/newbugon.cocci>bugon/newbugon.cocci</A>  -  Use BUG_ON
<pre>
	
	if (...) BUG(); should be replaced with BUG_ON(...) when the test has no
	side-effects to allow a definition of BUG_ON that drops the code completely.

</pre>
<A HREF=cache/cache.cocci>cache/cache.cocci</A>  -  Use kmem_cache_free
<pre>
	
	Free memory allocated using kmem_cache_zalloc using kmem_cache_free rather
	than kfree.

</pre>
<A HREF=call_kern1/call_kern1.cocci>call_kern1/call_kern1.cocci</A>  -  Use GFP_ATOMIC when a lock is held
<pre>
	
	The function adpt_i2o_post_wait is called from several places, in some of
	which, such as adpt_abort, a lock may be held.
	
	The functions adpt_i2o_reparse_lct and adpt_i2o_lct_get are called from
	several places, including adpt_rescan where a lock may be held.

</pre>
<A HREF=call_kern3/call_kern3.cocci>call_kern3/call_kern3.cocci</A>  -  Use GFP_ATOMIC when a lock is held
<pre>
	
	The containing function is called from several places.  At one of them, in
	the function untag_chunk, the spin lock &entry->lock is held.

</pre>
<A HREF=capi/capi.cocci>capi/capi.cocci</A>  -  Adjust error handling code involving capi_ctr_put
<pre>
	
	After calling capi_ctr_get, error handling code should call
	capi_ctr_put.

</pre>
<A HREF=clkput/clkput.cocci>clkput/clkput.cocci</A>  -  Add missing clk_put
<pre>
	
	Reorder the labels at the end of the function to correspond to the order in
	which the resources are allocated.

</pre>
<A HREF=consts/consts.cocci>consts/consts.cocci</A>  -  use the constant InterlaceMode
<pre>
	
	Use the constant InterlaceMode rather than the magic number 0x0080.

</pre>
<A HREF=countptr/countptr.cocci>countptr/countptr.cocci</A>  -  Remove exceptional & on function name
<pre>
	
	In this file, function names are otherwise used as pointers without &.

</pre>
<A HREF=cpu/cpu.cocci>cpu/cpu.cocci</A>  -  Adjust error handling code involving cpufreq_cpu_put
<pre>
	
	After calling cpufreq_cpu_get, error handling code should call
	cpufreq_cpu_put.

</pre>
<A HREF=cpu_mask/cpu_mask.cocci>cpu_mask/cpu_mask.cocci</A>  -  Use set_cpus_allowed_ptr
<pre>
	
	Use set_cpus_allowed_ptr rather than set_cpus_allowed.

</pre>
<A HREF=cpufreq/patch.cocci>cpufreq/patch.cocci</A>  -  Add calls to cpufreq_cpu_put
<pre>
	
	A call to cpufreq_cpu_get should be matched by a call to cpufreq_cpu_put.

</pre>
<A HREF=cris/mutex2.cocci>cris/mutex2.cocci</A>  -  Use mutex_unlock rather than spin_unlock
<pre>
	
	It looks at least odd to apply spin_unlock to a mutex.

</pre>
<A HREF=crypto/crypto.cocci>crypto/crypto.cocci</A>  -  Add NULL test around call to crypto_free_hash
<pre>
	
	crypto_free_hash calls the function crypto_hash_tfm and then
	crypto_free_tfm on the result.  crypto_free_tfm calls crypto_destroy_tfm,
	which tests this result for NULL and then dereferences it.  crypto_hash_tfm
	returns &tfm->base where tfm is its argument.  base is actually the first
	and only field of a crypto_hash-typed structure, so perhaps one can rely on
	it to return NULL for a NULL value of tfm.  But most calls to
	crypto_hash_tfm where the argument might be NULL don't rely on this
	property and test for NULL explicitly.

</pre>
<A HREF=cstptr/cstptr.cocci>cstptr/cstptr.cocci</A>  -  Move call to PTR_ERR after reassignment
<pre>
	
	PTR_ERR should be called before its argument is cleared.

</pre>
<A HREF=ctu/ctu.cocci>ctu/ctu.cocci</A>  -  Initialize all fields
<pre>
	
	The c32 structure is allocated on the stack and its idx field is not
	initialized before copying it to user level.  This patch takes the value
	from the result of the ioctl, as done for the other fields.

</pre>
<A HREF=da/da.cocci>da/da.cocci</A>  -  Correct double assignment
<pre>
	
	The double assignment is meant to be a bit-or to combine two values.

</pre>
<A HREF=dall/dall.cocci>dall/dall.cocci</A>  -  Use devm_ functions consistently
<pre>
	
	Use devm_kzalloc for all calls to kzalloc and not just the first.  Use devm
	functions for other allocations as well.
	
	Move the call to platform_get_resource(pdev, IORESOURCE_MEM, 0) closer to
	where its result is passed to devm_request_and_ioremap to make the lack of
	need for a NULL test more evident.

</pre>
<A HREF=dangling/dangling.cocci>dangling/dangling.cocci</A>  -  Remove potential for use after free
<pre>
	
	In each function, the value apcm is stored in the private_data field of
	runtime.  At the same time the function ct_atc_pcm_free_substream is stored
	in the private_free field of the same structure.  ct_atc_pcm_free_substream
	dereferences and ultimately frees the value in the private_data field.  But
	each function can exit in an error case with apcm having been freed, in
	which case a subsequent call to the private_free function would perform a
	dereference after free.  On the other hand, if the private_free field is
	not initialized, it is NULL, and not invoked (see snd_pcm_detach_substream
	in sound/core/pcm.c).  To avoid the introduction of a dangling pointer, the
	initializations of the private_data and private_free fields are moved to
	the end of the function, past any possible free of apcm.  This is safe
	because the previous calls to snd_pcm_hw_constraint_integer and
	snd_pcm_hw_constraint_minmax, which take runtime as an argument, do not
	refer to either of these fields.
	
	In each function, there is one error case where apcm needs to be freed, and
	a call to kfree is added.

</pre>
<A HREF=depspin/sl.cocci>depspin/sl.cocci</A>  -  Use DEFINE_SPINLOCK
<pre>
	
	SPIN_LOCK_UNLOCKED is deprecated. The semantic patch makes the change
	suggested in Documentation/spinlocks.txt

</pre>
<A HREF=derefnull/isnull.cocci>derefnull/isnull.cocci</A>  -  Detect null dereference and unnecessary test
<pre>
	
	Detect null dereference and unnecessary test

</pre>
<A HREF=devm2/devm2i.cocci>devm2/devm2i.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses devm_kzalloc, devm_request_irq, etc. for data
	that is allocated in the probe function of a platform device and is only
	freed in the remove function.
	
	This patch changes the semantics in the case of exynos_hdmi.c, in that in
	the original code, there was no free of drm_hdmi_ctx in the remove function.

</pre>
<A HREF=devm2a/devm2i.cocci>devm2a/devm2i.cocci</A>  -  use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.

</pre>
<A HREF=devm2b/devm2i.cocci>devm2b/devm2i.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.
	
	By using devm_ioremap, it also removes a potential memory leak, because
	there was no call to iounmap in the probe function.
	
	The call to platform_get_resource was moved just to make it closer to the
	place where its result it used.

</pre>
<A HREF=devm2i_0729/devm2i.cocci>devm2i_0729/devm2i.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.
	
	A new label name is created in one case to better reflect the contents of
	the error-handling code.

</pre>
<A HREF=devm2i_0729/request_and_ioremap.cocci>devm2i_0729/request_and_ioremap.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.
	
	A new label name is created in one case to better reflect the contents of
	the error-handling code.

</pre>
<A HREF=devm2i_0730/devm2i.cocci>devm2i_0730/devm2i.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.

</pre>
<A HREF=devm2i_0730/request_and_ioremap.cocci>devm2i_0730/request_and_ioremap.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.

</pre>
<A HREF=devm2i_0731/devm2i.cocci>devm2i_0731/devm2i.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.
	
	The call to platform_get_resource(pdev, IORESOURCE_MEM, 0) is moved closer
	to the new call to devm_request_and_ioremap where its result is first
	used.  devm_request_and_ioremap takes case of the NULL test on the result
	of platform_get_resource(pdev, IORESOURCE_MEM, 0), so that is dropped.

</pre>
<A HREF=devm2i_0731/request_and_ioremap.cocci>devm2i_0731/request_and_ioremap.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.
	
	The call to platform_get_resource(pdev, IORESOURCE_MEM, 0) is moved closer
	to the new call to devm_request_and_ioremap where its result is first
	used.  devm_request_and_ioremap takes case of the NULL test on the result
	of platform_get_resource(pdev, IORESOURCE_MEM, 0), so that is dropped.

</pre>
<A HREF=devm2i_aug25/devm2i.cocci>devm2i_aug25/devm2i.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.

</pre>
<A HREF=devm2i_aug25/request_and_ioremap.cocci>devm2i_aug25/request_and_ioremap.cocci</A>  -  Use devm_ functions
<pre>
	
	The various devm_ functions allocate memory that is released when a driver
	detaches.  This patch uses these functions for data that is allocated in
	the probe function of a platform device and is only freed in the remove
	function.

</pre>
<A HREF=devm4/devm4.cocci>devm4/devm4.cocci</A>  -  Drop iounmap for devm_ allocated data
<pre>
	
	Data allocated with devm_ioremap or devm_ioremap_nocache should not be
	freed using iounmap, because doing so causes a dangling pointer, and a
	subsequent double free.

</pre>
<A HREF=devm6/devm6.cocci>devm6/devm6.cocci</A>  -  Use devm_request_and_ioremap
<pre>
	
	Reimplement a call to devm_request_mem_region followed by a call to ioremap
	or ioremap_nocache by a call to devm_request_and_ioremap.

</pre>
<A HREF=devname/devname.cocci>devname/devname.cocci</A>  -  Eliminate NULL dereference
<pre>
	
	dev_name always dereferences its argument, so it should not be called if
	the argument is NULL.  The function indeed later tests the argument for
	being NULL.

</pre>
<A HREF=diou/diou.cocci>diou/diou.cocci</A>  -  drop kfree of devm_kzalloc's data
<pre>
	
	Using kfree to free data allocated with devm_kzalloc causes double frees.

</pre>
<A HREF=diou2/diou.cocci>diou2/diou.cocci</A>  -  Drop devm_kfree of devm_kzalloc'd data
<pre>
	
	devm_kfree should not have to be explicitly used.

</pre>
<A HREF=diou3/devm3.cocci>diou3/devm3.cocci</A>  -  Some devm_ cleanups
<pre>
	
	devm free functions should not have to be explicitly used.
	
	The only thing left that is useful in the function mpc5121_nfc_free is the
	call to clk_disable, which is moved to the call sites.
	
	This function also incorrectly called iounmap on devm_ioremap allocated
	data.
	
	Use devm_request_and_ioremap in place of devm_request_mem_region and
	devm_ioremap.
	
	Use devm_clk_get.

</pre>
<A HREF=dma/set_dma_mode_1.cocci>dma/set_dma_mode_1.cocci</A>  -  Avoid using magic number in set_dma_mode
<pre>
	
	The constant DMA_RX_MODE is defined to be 0x14 in the local include file
	cs89x0.h.  Since a constant with the same name is used elsewhere with
	set_dma_mode, it seems likely that this constant could be used here.

</pre>
<A HREF=double_call/dc.cocci>double_call/dc.cocci</A>  -  Eliminate useless code
<pre>
	
	The variable client is initialized twice to the same (side effect-free)
	expression.  Drop one initialization.

</pre>
<A HREF=double_lock/double_lock.cocci>double_lock/double_lock.cocci</A>  -  Eliminate a double lock
<pre>
	
	The path around the loop ends with the lock held, so the call to mutex_lock
	is moved before the beginning of the loop.

</pre>
<A HREF=double_null/double_null.cocci>double_null/double_null.cocci</A>  -  Correct NULL test
<pre>
	
	Test the value that was just allocated rather than the previously tested one.

</pre>
<A HREF=double_test/double_test.cocci>double_test/double_test.cocci</A>  -  Introduce missing initialization
<pre>
	
	The result of one call to a function is tested, and then at the second call
	to the same function, the previous result, and not the current result, is
	tested again.

</pre>
<A HREF=doublefree/frees.cocci>doublefree/frees.cocci</A>  -  Eliminate double kfree
<pre>
	
	The destination of goto error also does a kfree(g_iommus), so it is not
	correct to do one here.

</pre>
<A HREF=doubleinit/doubleinit.cocci>doubleinit/doubleinit.cocci</A>  -  Remove duplicate structure field initialization
<pre>
	
	The definition of uml_netdev_ops has initializations of a local function
	and eth_mac_addr for its ndo_set_mac_address field.  This change uses only
	the local function.

</pre>
<A HREF=doublermr/doublermr.cocci>doublermr/doublermr.cocci</A>  -  Improve error handling
<pre>
	
	This code had an error handling goto to the wrong place, a misplaced
	release_mem_region, and a duplicated release_mem_region.

</pre>
<A HREF=doubletest/doubletest.cocci>doubletest/doubletest.cocci</A>  -  Remove double test
<pre>
	
	The current code tests the gpio_vid0 field twice.  Test the gpio_vid1
	fields in place of the second gpio_vid0 test.

</pre>
<A HREF=doubletest_high/doubletest_highconfidence.cocci>doubletest_high/doubletest_highconfidence.cocci</A>  -  Adjust double test
<pre>
	
	Rewrite a duplicated test to test the correct value

</pre>
<A HREF=drop_continue/cont.cocci>drop_continue/cont.cocci</A>  -  Drop unnecessary continue
<pre>
	
	Continue is not needed at the bottom of a loop.

</pre>
<A HREF=drvdata/drvdata.cocci>drvdata/drvdata.cocci</A>  -  Use dev_set_drvdata
<pre>
	
	Eliminate direct accesses to the driver_data field.

</pre>
<A HREF=dst/dst.cocci>dst/dst.cocci</A>  -  Use dst_type field instead of type_flags
<pre>
	
	It seems from other code that it is the dst_type field rather than the
	type_flags field that contains values of the form DST_TYPE_IS...
	The type_flags field contains values of the form DST_TYPE_HAS...

</pre>
<A HREF=enter/enter.cocci>enter/enter.cocci</A>  -  Convert func_enter to func_exit
<pre>
	
	Convert calls to func_enter on leaving a function to func_exit.

</pre>
<A HREF=epd/epd.cocci>epd/epd.cocci</A>  -  Use USB API functions rather than constants
<pre>
	
	This set of patches introduces calls to the following set of functions:
	
	usb_endpoint_dir_in(epd)
	usb_endpoint_dir_out(epd)
	usb_endpoint_is_bulk_in(epd)
	usb_endpoint_is_bulk_out(epd)
	usb_endpoint_is_int_in(epd)
	usb_endpoint_is_int_out(epd)
	usb_endpoint_num(epd)
	usb_endpoint_type(epd)
	usb_endpoint_xfer_bulk(epd)
	usb_endpoint_xfer_control(epd)
	usb_endpoint_xfer_int(epd)
	usb_endpoint_xfer_isoc(epd)
	
	In some cases, introducing one of these functions is not possible, and it
	just replaces an explicit integer value by one of the following constants:
	
	USB_ENDPOINT_XFER_BULK
	USB_ENDPOINT_XFER_CONTROL
	USB_ENDPOINT_XFER_INT
	USB_ENDPOINT_XFER_ISOC

</pre>
<A HREF=epd/mini.cocci>epd/mini.cocci</A>  -  Use USB API functions rather than constants
<pre>
	
	This set of patches introduces calls to the following set of functions:
	
	usb_endpoint_dir_in(epd)
	usb_endpoint_dir_out(epd)
	usb_endpoint_is_bulk_in(epd)
	usb_endpoint_is_bulk_out(epd)
	usb_endpoint_is_int_in(epd)
	usb_endpoint_is_int_out(epd)
	usb_endpoint_num(epd)
	usb_endpoint_type(epd)
	usb_endpoint_xfer_bulk(epd)
	usb_endpoint_xfer_control(epd)
	usb_endpoint_xfer_int(epd)
	usb_endpoint_xfer_isoc(epd)
	
	In some cases, introducing one of these functions is not possible, and it
	just replaces an explicit integer value by one of the following constants:
	
	USB_ENDPOINT_XFER_BULK
	USB_ENDPOINT_XFER_CONTROL
	USB_ENDPOINT_XFER_INT
	USB_ENDPOINT_XFER_ISOC

</pre>
<A HREF=epdneg/epdneg.cocci>epdneg/epdneg.cocci</A>  -  Use negated usb_endpoint_xfer_control, etc
<pre>
	
	This patch extends 42a6e66f1e40a930d093c33ba0bb9d8d8e4555ed by using
	usb_endpoint_xfer_control, usb_endpoint_xfer_isoc, usb_endpoint_xfer_bulk,
	and usb_endpoint_xfer_int in the negated case as well.
	
	This patch also rewrites some calls to usb_endpoint_dir_in as negated calls
	to !usb_endpoint_dir_out, and vice versa, to better correspond to the
	intent of the original code.

</pre>
<A HREF=even_more_pci/get_slot.cocci>even_more_pci/get_slot.cocci</A>  -  Add missing pci_dev_get
<pre>
	
	pci_get_slot does a pci_dev_get, so pci_dev_put needs to be called in an
	error case.
	
	In the first three cases, it might also be possible to move the call to
	pci_get_slot downwards below the error handling code.

</pre>
<A HREF=extra_put/extra_put.cocci>extra_put/extra_put.cocci</A>  -  Drop unneeded of_node_put
<pre>
	
	After using for_each_node_by_name, there is no need for of_node_put unless
	there was a break in the loop body, as for_each_node_by_name does a
	of_node_put on each of the elements it returns.

</pre>
<A HREF=fbrelease/metapatch.cocci>fbrelease/metapatch.cocci</A>  -  Eliminate double free
<pre>
	
	The function framebuffer_release just calls kfree, so calling kfree
	subsequently on the same argument represents a double free.  The
	comments with the definition of framebuffer_release
	in drivers/video/fbsysfs.c suggest that a more elaborate definition of this
	function is planned, such that the splitting up of framebuffer_release and
	kfree as done in the second instance might someday make sense, but it does
	not make sense now. 

</pre>
<A HREF=fbrelease/patch.cocci>fbrelease/patch.cocci</A>  -  eliminate double free
<pre>
	
	The function framebuffer_release just calls kfree, so calling kfree
	subsequently on the same argument represents a double free.  The
	comments with the definition of framebuffer_release
	in drivers/video/fbsysfs.c suggest that a more elaborate definition of this
	function is planned, such that the splitting up of framebuffer_release and
	kfree as done in the second instance might someday make sense, but it does
	not make sense now. 

</pre>
<A HREF=fen/fen.cocci>fen/fen.cocci</A>  -  Drop unnecessary of_node_put
<pre>
	
	for_each_node_by_name only exits when its first argument is NULL, and a
	subsequent call to of_node_put on that argument is unnecessary.

</pre>
<A HREF=fields/field.cocci>fields/field.cocci</A>  -  Use FIELD_SIZEOF
<pre>
	
	Robert P.J. Day proposed to use the macro FIELD_SIZEOF in replace of code
	that matches its definition.

</pre>
<A HREF=frfr/frfr.cocci>frfr/frfr.cocci</A>  -  Eliminate double free
<pre>
	
	The few lines below the kfree of hdr_buf may go to the label err_free which
	will also free hdr_buf.  The most straightforward solution seems to be to
	just move the kfree of hdr_buf after these gotos.

</pre>
<A HREF=fuse/fuse.cocci>fuse/fuse.cocci</A>  -  Add missing fuse_request_alloc
<pre>
	
	The error handling code for the second call to fuse_request_alloc should
	include freeing the result of the first one.

</pre>
<A HREF=gdth/gdth.cocci>gdth/gdth.cocci</A>  -  Add missing call to gdth_ioctl_free
<pre>
	
	Add missing call to gdth_ioctl_free before aborting.

</pre>
<A HREF=gfs2/category2a_gfs2_inode_lookup.cocci>gfs2/category2a_gfs2_inode_lookup.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, the function gfs2_inode_lookup returns an
	ERR pointer, but never returns a NULL pointer. So a NULL test that
	necessarily comes after an IS_ERR test should be deleted, and a NULL
	test that may come after a call to this function should be
	strengthened by an IS_ERR test.

</pre>
<A HREF=gmc/gmc.cocci>gmc/gmc.cocci</A>  -  Avoid call to genlmsg_cancel
<pre>
	
	genlmsg_cancel subtracts some constants from its second argument before
	calling nlmsg_cancel.  nlmsg_cancel then calls nlmsg_trim on the same
	arguments.  nlmsg_trim tests for NULL before doing any computation, but a
	NULL second argument to genlmsg_cancel is no longer NULL due to the initial
	subtraction.  Nothing else happens in this execution, so the call to
	genlmsg_cancel is simply unnecessary in this case.

</pre>
<A HREF=handle/handle.cocci>handle/handle.cocci</A>  -  Adjust error handling code
<pre>
	
	In this code, it is possible to tell statically whether usblp will be NULL
	in the error handling code.
	
	Another option would have been to put a label directly on the return.

</pre>
<A HREF=hrtimer/hrtimer.cocci>hrtimer/hrtimer.cocci</A>  -  Use function hrtimer_is_queued
<pre>
	
	Use the hrtimer_is_queued function rather than an explicit bit-and for
	testing timer->state, as done elsewhere.

</pre>
<A HREF=i2c_msg/i2c_msg.cocci>i2c_msg/i2c_msg.cocci</A>  -  Use macros for i2c_msg initialization
<pre>
	
	Introduce use of I2c_MSG_READ/WRITE/OP, for readability.
	
	In the second i2c_msg structure, a length expressed as an explicit constant
	is also re-expressed as the size of the buffer, reg.

</pre>
<A HREF=i915/sp1517.cocci>i915/sp1517.cocci</A>  -  Add missing error handling code
<pre>
	
	The cleanup code at the end of the function should also be carried out when
	the function only partly completes its work.

</pre>
<A HREF=ie2/ie2.cocci>ie2/ie2.cocci</A>  -  Convert IS_ERR result to PTR_ERR
<pre>
	
	This code elsewhere returns a negative constant to an indicate an error,
	while IS_ERR returns the result of a >= operation.

</pre>
<A HREF=if-semicolon/if-semicolon.cocci>if-semicolon/if-semicolon.cocci</A>  -  Detect semicolon after if
<pre>
	
	Detect a semicolon after if(...) that is preventing the error check to
	work correctly. Removing this semicolon will change the code behavior,
	but this is intended.

</pre>
<A HREF=ifcol/ifcol.cocci>ifcol/ifcol.cocci</A>  -  Adjust confusing if indentation
<pre>
	
	Outdent the code following the if.

</pre>
<A HREF=iff/iff.cocci>iff/iff.cocci</A>  -  Fix error return code
<pre>
	
	Convert a possibly 0 error return code to a negative one, as returned
	elsewhere in the function.

</pre>
<A HREF=ifseqerr/ifseqerr.cocci>ifseqerr/ifseqerr.cocci</A>  -  Remove unnecessary error check
<pre>
	
	This code does not call deinit_card(card); in an error case, as done in
	other error-handling code in the same function.  But actually, the called
	function init_sram can only return 0, so there is no need for the error
	check at all.
	
	init_sram is also given a void return type, and its single return statement
	at the end of the function is dropped.

</pre>
<A HREF=incon/incon3.cocci>incon/incon3.cocci</A>  -  eliminate possible double free
<pre>
	
	The function __iio_add_event_config_attrs is only called once, by the
	function iio_device_register_eventset.  If the call fails,
	iio_device_register_eventset calls __iio_remove_event_config_attrs.  There
	is thus no need for __iio_add_event_config_attrs to also call
	__iio_remove_event_config_attrs on failure.

</pre>
<A HREF=infiniband/category2a_ib_create_send_mad.cocci>infiniband/category2a_ib_create_send_mad.cocci</A>  -  Use a NULL test rather than an IS_ERR test
<pre>
	
	In case of error, the function ib_create_send_mad returns an ERR pointer,
	but never returns a NULL pointer. So after a call to this function,
	a NULL test should be replaced by an IS_ERR test.

</pre>
<A HREF=infiniband/category2a_ucma_alloc_multicast.cocci>infiniband/category2a_ucma_alloc_multicast.cocci</A>  -  Use a NULL test rather than an IS_ERR test
<pre>
	
	In case of error, the function ucma_alloc_multicast returns a NULL
	pointer, but never returns an ERR pointer. So after a call to this
	function, an IS_ERR test should be replaced by a NULL test.

</pre>
<A HREF=input/sp2486.cocci>input/sp2486.cocci</A>  -  Correct call to input_free_device
<pre>
	
	Correct call to input_free_device

</pre>
<A HREF=input/sp2495.cocci>input/sp2495.cocci</A>  -  Correct call to input_free_device
<pre>
	
	Correct call to input_free_device

</pre>
<A HREF=input/sp2506.cocci>input/sp2506.cocci</A>  -  Correct call to input_free_device
<pre>
	
	Correct call to input_free_device

</pre>
<A HREF=iom/devm2i.cocci>iom/devm2i.cocci</A>  -  Add missing iounmap
<pre>
	
	Add missing iounmap in error handling code, in a case where the function
	already preforms iounmap on some other execution path.

</pre>
<A HREF=iom/iom.cocci>iom/iom.cocci</A>  -  Add missing iounmap
<pre>
	
	Add missing iounmap in error handling code, in a case where the function
	already preforms iounmap on some other execution path.

</pre>
<A HREF=iounmap/ioremap_check.cocci>iounmap/ioremap_check.cocci</A>  -  Add missing iounmap
<pre>
	
	An extra error handling label is needed for the case where the ioremap has
	succeeded.

</pre>
<A HREF=is_static/is_static.cocci>is_static/is_static.cocci</A>  -  Make some structures static
<pre>
	
	Checks that the declaration is not inside a function definition, that the
	defined variable is not exported using EXPORTED_SYMBOL, etc, and that the
	defined variable does not occur in any other file.  If these conditions
	hold, static is added before the declaration.

</pre>
<A HREF=iserr/patch1.cocci>iserr/patch1.cocci</A>  -  Test for IS_ERR rather than 0
<pre>
	
	The function gfs2_inode_lookup always returns either a valid pointer or a
	value made with ERR_PTR, so its result should be tested with IS_ERR, not
	with a test for 0. This semantic patch detect candidates for the change.

</pre>
<A HREF=iserr/patch2.cocci>iserr/patch2.cocci</A>  -  Test for IS_ERR rather than 0
<pre>
	
	The function ocfs2_start_trans always returns either a valid pointer or a
	value made with ERR_PTR, so its result should be tested with IS_ERR, not
	with a test for 0. This semantic patch detect candidates for the changes.

</pre>
<A HREF=iserr/patch3.cocci>iserr/patch3.cocci</A>  -  Test for IS_ERR rather than 0
<pre>
	
	The function rdma_create_id always returns either a valid pointer or a
	value made with ERR_PTR, so its result should be tested with IS_ERR, not
	with a test for 0. This semantic patch detect candidates for the change.

</pre>
<A HREF=iserr/patch45.cocci>iserr/patch45.cocci</A>  -  Test for IS_ERR rather than 0
<pre>
	
	The function thermal_cooling_device_register always returns either a valid
	pointer or a value made with ERR_PTR, so a test for non-zero on the result
	will always succeed. This semantic patch detect candidates for the change.

</pre>
<A HREF=iserr/send_ct.cocci>iserr/send_ct.cocci</A>  -  Simplify error handling
<pre>
	
	nf_conntrack_alloc cannot return NULL, so there is no need to check for
	NULL before using the value.  I have also removed the initialization of ct
	to NULL in nf_conntrack_alloc, since the value is never used, and since
	perhaps it might lead one to think that return ct at the end might return
	NULL. This semantic patch detect candidates for the changes.

</pre>
<A HREF=iserr_cata/category2a.cocci>iserr_cata/category2a.cocci</A>  -  Correct error-handling code
<pre>
	
	The function returns an ERR_PTR value in an error case instead of NULL.
	Thus the test that file is not NULL is always true.

</pre>
<A HREF=iserr_ref/iserr_mini.cocci>iserr_ref/iserr_mini.cocci</A>  -  Correct an error check
<pre>
	
	rtc is clearly does not satisfy IS_ERR at the point where it is tested, so
	I have changed the test to consider the just initialized rtc->rtc_dev.

</pre>
<A HREF=iserr_ref/iserr_ref.cocci>iserr_ref/iserr_ref.cocci</A>  -  Correct an error check
<pre>
	
	rtc is clearly does not satisfy IS_ERR at the point where it is tested, so
	I have changed the test to consider the just initialized rtc->rtc_dev.

</pre>
<A HREF=iserreq/ise2.cocci>iserreq/ise2.cocci</A>  -  use PTR_ERR to get error code
<pre>
	
	IS_ERR returns only 1 or 0.  The callsite of setup_regulators expects a
	negative integer in an error case.  Thus, PTR_ERR has to be used to extract
	it.

</pre>
<A HREF=isnull_oct/isnull.cocci>isnull_oct/isnull.cocci</A>  -  Eliminate a null pointer dereference
<pre>
	
	In the original code, probe_out could be reached when res was null and then
	when the irq had not yet been requested.  In those cases, the call to
	free_irq is not needed, so move probe_out down and introduce a new label
	for the case where calling free_irq is useful.

</pre>
<A HREF=isnullo/isnull.cocci>isnullo/isnull.cocci</A>  -  Keep pointer to resource so it can be freed
<pre>
	
	Add a new variable for storing resources accessed subsequent to the one
	accessed using request_mem_region, so the one accessed using
	request_mem_region can be released if needed.
	
	The resource variable names are also changed to be more descriptive.
	
	This code is also missing some calls to iounmap.

</pre>
<A HREF=itnull/itnull.cocci>itnull/itnull.cocci</A>  -  Drop unnecessary null test
<pre>
	
	list_for_each_entry binds its first argument to a non-null value, and thus
	any null test on the value of that argument is superfluous.

</pre>
<A HREF=iwcontainer/extra_null.cocci>iwcontainer/extra_null.cocci</A>  -  Drop unnecessary NULL test
<pre>
	

</pre>
<A HREF=jiffies/jiffies.cocci>jiffies/jiffies.cocci</A>  -  Use time_before, time_before_eq, etc
<pre>
	
	The functions time_before, time_before_eq, time_after, and time_after_eq
	are more robust for comparing jiffies against other values.

</pre>
<A HREF=k-zc-alloc/kzalloc.cocci>k-zc-alloc/kzalloc.cocci</A>  -  Transform some kzalloc calls to kcalloc
<pre>
	
	Transform some kzalloc calls to kcalloc in staging/hv

</pre>
<A HREF=kasp/kasp.cocci>kasp/kasp.cocci</A>  -  Eliminate kstrdup memory leak
<pre>
	
	The string clone is only used as a temporary copy of the argument val
	within the while loop, and so it should be freed before leaving the
	function.  The call to strsep, however, modifies clone, so a pointer to the
	front of the string is kept in saved_clone, to make it possible to free it.

</pre>
<A HREF=kasprintf2/aspmem.cocci>kasprintf2/aspmem.cocci</A>  -  Use kstrdup
<pre>
	
	Rewrite the initialization of a dev field.  In the original code, in each
	case there was a kmalloc followed by a memcpy, as illustrated by the
	semantic patch below.  In the case that the provided string was the empty
	string, the allocated memory was then overwritten with a constant string,
	causing a memory leak.  Finally, there was no provision for returning
	-ENOMEM in case of failure of the memory allocation.  Indeed, the return
	value in an error case was err, a variable that was never initialized to
	anything other than 0.
	
	The following patch rewrites the above code to first select a string based
	on various conditions, and then to copy it into a newly allocated memory
	region, using kstrdup.  This decreases subtantially the code size
	and removes the memory leak.  The instruction for getting the length of the
	string and the associated variable declaration are also deleted.
	
	The patch also drops err, changes the return value to retval, which in each
	file was already initialized elsewhere to an error code, and initializes
	retval to -ENOMEM when kstrdup fails.

</pre>
<A HREF=kc/kc.cocci>kc/kc.cocci</A>  -  Use kzalloc for allocating only one thing
<pre>
	
	Use kzalloc rather than kcalloc(1,...)

</pre>
<A HREF=kfree3/kmalloc.cocci>kfree3/kmalloc.cocci</A>  -  Introduce missing kfree
<pre>
	
	Error handling code following a kzalloc should free the allocated data.

</pre>
<A HREF=kfree3/kmalloc8a.cocci>kfree3/kmalloc8a.cocci</A>  -  Introduce missing kfree
<pre>
	
	Error handling code following a kzalloc should free the allocated data.

</pre>
<A HREF=kfree_after/kfree_after.cocci>kfree_after/kfree_after.cocci</A>  -  Adjust error handling code
<pre>
	
	Use the error handling code at the end of the function, rather than
	returning directly.

</pre>
<A HREF=kfree_after2/kfree_after.cocci>kfree_after2/kfree_after.cocci</A>  -  Remove unneeded kfree
<pre>
	
	The label outnodev is only used when kzalloc has not yet taken place or has
	failed, so there is no need for the call for kfree under this label.

</pre>
<A HREF=kfree_skb/skbfree.cocci>kfree_skb/skbfree.cocci</A>  -  Convert kfree/kfree_skb to dev_kfree_skb_irq
<pre>
	
	When values of type struct sk_buff * are freed from within an interrupt
	handler, dev_kfree_skb_irq should be used rather than kfree or kfree_skb.
	
	In most of the cases below, the function containing the free ends up as a
	URB completion callback.  Such callbacks are called from an interrupt
	handler.  In drivers/bluetooth/btsdio.c, the enclosing function is
	ultimately referenced from the second argument of sdio_claim_irq, which is
	also used as an interrupt handler.

</pre>
<A HREF=kfrees/kfree.cocci>kfrees/kfree.cocci</A>  -  Introduce missing kfree
<pre>
	
	Introduce missing kfree

</pre>
<A HREF=kmalloc9/kmalloc9.cocci>kmalloc9/kmalloc9.cocci</A>  -  Add missing kfree
<pre>
	
	At this point, ehv_pic has been allocated but not stored anywhere, so it
	should be freed before leaving the function.

</pre>
<A HREF=kmc1/kmc1.cocci>kmc1/kmc1.cocci</A>  -  Free kmem_cache_zalloc'd data using kmem_cache_free
<pre>
	
	Memory allocated using kmem_cache_zalloc should be freed using
	kmem_cache_free, not kfree.

</pre>
<A HREF=kmc1a/kmc1.cocci>kmc1a/kmc1.cocci</A>  -  eliminate NULL pointer dereference
<pre>
	
	In this code, blkvsc_req is allocated in the cache blkdev->request_pool,
	but freed in the first case to the cache blkvsc_req->dev->request_pool.
	blkvsc_req->dev is subsequently initialized to blkdev, making these the
	same at the second call to kmem_cache_free.  But at the point of the first
	call, blkvsc_req->dev is NULL.  The second call is changed too, for
	uniformity.

</pre>
<A HREF=kmtest/kmtest.cocci>kmtest/kmtest.cocci</A>  -  Add kmalloc NULL tests
<pre>
	
	Check that the result of kmalloc/kzalloc is not NULL before dereferencing it.

</pre>
<A HREF=kstr/kstr.cocci>kstr/kstr.cocci</A>  -  Use kstrtoul, etc
<pre>
	
	Use kstrtoul, etc instead of the now deprecated strict_strtoul, etc.

</pre>
<A HREF=kstrdup/kstrdup.cocci>kstrdup/kstrdup.cocci</A>  -  Use kstrdup
<pre>
	
	Use kstrdup when the goal of an allocation is copy a string into the
	allocated region.

</pre>
<A HREF=lcd/category2b_back_device_reg.cocci>lcd/category2b_back_device_reg.cocci</A>  -  Bad error test before a dereference
<pre>
	
	The error test that follows the call to backlight_device_register
	seems not to concern the right variable.

</pre>
<A HREF=lenull/lenull.cocci>lenull/lenull.cocci</A>  -  Drop NULL test on list_entry result
<pre>
	
	list_entry, which is an alias for container_of, cannot return NULL, as
	there is no way to add a NULL value to a doubly linked list.

</pre>
<A HREF=leq/leq.cocci>leq/leq.cocci</A>  -  Use ERR_PTR/IS_ERR
<pre>
	
	Use ERR_PTR and IS_ERR rather than mixing integers and pointers.

</pre>
<A HREF=lfee/lfee.cocci>lfee/lfee.cocci</A>  -  Remove invalid reference to list iterator variable
<pre>
	
	If list_for_each_entry, etc complete a traversal of the list, the iterator
	variable ends up pointing to an address at an offset from the list head,
	and not a meaningful structure.  Thus this value should not be used after
	the end of the iterator.  Replace c->dev by dev, which is the value that
	c->dev has been compared to.

</pre>
<A HREF=list_entry/rcu2.cocci>list_entry/rcu2.cocci</A>  -  Use list_for_each_entry instead of list_for_each
<pre>
	
	Use list_for_each_entry instead of list_for_each in sound/oss drivers.

</pre>
<A HREF=list_entry_update/list_entry_update.cocci>list_entry_update/list_entry_update.cocci</A>  -  Eliminate update of list_for_each_entry loop cursor
<pre>
	
	list_for_each_entry uses its first argument to move from one element to the
	next, so modifying it can break the iteration.

</pre>
<A HREF=listfree/listfree.cocci>listfree/listfree.cocci</A>  -  Avoid leaving freed data in a list
<pre>
	
	The list_for_each_entry loop can fail, in which case the list element is
	not removed from the list.  Since this list is not accessed by the loop, 
	the addition of &data->list into the list is just moved after the loop.

</pre>
<A HREF=local/local.cocci>local/local.cocci</A>  -  Add local_irq_restore in error handling code
<pre>
	
	The gotos to the labels fail_free_irq and fail_unregister only occur
	between local_irq_save and local_irq_restore, so it would seem that this
	code should also call local_irq_restore.

</pre>
<A HREF=lock/o_lock_inconsistent.cocci>lock/o_lock_inconsistent.cocci</A>  -  Unlock the lock that was locked
<pre>
	
	The lock taken was in the ct_ev_lock field, not the hbalock field.

</pre>
<A HREF=lock_flags/flags1.cocci>lock_flags/flags1.cocci</A>  -  Convert nested spin_lock_irqsave to spin_lock
<pre>
	
	If spin_lock_irqsave is called twice in a row with the same second
	argument, the interrupt state at the point of the second call overwrites
	the value saved by the first call.  Indeed, the second call does not need
	to save the interrupt state, so it is changed to a simple spin_lock.

</pre>
<A HREF=map_destroy/map_destroy.cocci>map_destroy/map_destroy.cocci</A>  -  avoid calling map_destroy on NULL
<pre>
	
	map_destroy dereferences its argument.  The call is furthermore only
	reachable when this argument is NULL.  Thus the call is dropped.

</pre>
<A HREF=markbusy/usb_mark_last_busy.cocci>markbusy/usb_mark_last_busy.cocci</A>  -  Use usb_mark_last_busy
<pre>
	
	This introduces uses of the function usb_mark_last_busy, define in 
	include/linux/usb.h. This function only has an effect if 
	CONFIG_USB_SUSPEND is set.  

</pre>
<A HREF=mdiobus_unregister/mdiobus_unregister.cocci>mdiobus_unregister/mdiobus_unregister.cocci</A>  -  Call mdiobus_unregister before mdiobus_free
<pre>
	
	Based on commit b27393aecf66199f5ddad37c302d3e0cfadbe6c0
	
	Calling mdiobus_free without calling mdiobus_unregister causes
	BUG_ON(). This patch fixes the issue.

</pre>
<A HREF=mem2/mem2.cocci>mem2/mem2.cocci</A>  -  drop redundant memset
<pre>
	
	The region set by the call to memset is immediately overwritten by the
	subsequent call to memcpy.

</pre>
<A HREF=memdup/memdup.cocci>memdup/memdup.cocci</A>  -  Use kmemdup instead of allocate and memcpy
<pre>
	
	Use kmemdup when some other buffer is immediately copied into the
	allocated region.

</pre>
<A HREF=memdup_user/memdup_user.cocci>memdup_user/memdup_user.cocci</A>  -  Use memdup_user
<pre>
	
	Use memdup_user when user data is immediately copied into the
	allocated region.

</pre>
<A HREF=memuser/memuser.cocci>memuser/memuser.cocci</A>  -  Add missing kfree
<pre>
	
	The label fail frees dev->buf, but kbuf hasn't yet been stored there at
	this point.

</pre>
<A HREF=mesh/mesh.cocci>mesh/mesh.cocci</A>  -  Correct the argument to __mesh_table_free
<pre>
	
	In the function mesh_table_grow, it is the new table not the argument table
	that should be freed if the function fails (cf commit
	bd9b448f4c0a514559bdae4ca18ca3e8cd999c6d)

</pre>
<A HREF=mini_lock/mini_lock.cocci>mini_lock/mini_lock.cocci</A>  -  Add missing spin_unlock
<pre>
	
	Add a spin_unlock missing on the error path.  The spin lock is used in a
	balanced way elsewhere in the file.

</pre>
<A HREF=mini_null/mini_null_ref.cocci>mini_null/mini_null_ref.cocci</A>  -  Move a dereference below a NULL test
<pre>
	
	In each case, if the NULL test is necessary, then the dereference should be
	moved below the NULL test.

</pre>
<A HREF=mini_null3/mini_null_ref3.cocci>mini_null3/mini_null_ref3.cocci</A>  -  Move a dereference below a NULL test
<pre>
	
	If the NULL test is necessary, then the dereference should be moved below
	the NULL test.

</pre>
<A HREF=mini_null_check/mini_null_check.cocci>mini_null_check/mini_null_check.cocci</A>  -  Drop an unneeded a NULL test
<pre>
	
	In each case, the NULL test is not necessary because the function is static
	and at the only places where it is called, the us argument has already been
	dereferenced.

</pre>
<A HREF=mini_null_check/second_mini_null_check.cocci>mini_null_check/second_mini_null_check.cocci</A>  -  Drop an unneeded a NULL test
<pre>
	
	In each case, the NULL test is not necessary because the function is static
	and at the only places where it is called, the us argument has already been
	dereferenced.

</pre>
<A HREF=mini_null_ref_aug10/mini_null_ref.cocci>mini_null_ref_aug10/mini_null_ref.cocci</A>  -  Remove potential NULL dereference
<pre>
	
	If the NULL test is necessary, the initialization involving a dereference of
	the tested value should be moved after the NULL test.

</pre>
<A HREF=mini_null_ref_aug14/mini_null_ref.cocci>mini_null_ref_aug14/mini_null_ref.cocci</A>  -  Remove potential NULL dereferences
<pre>
	
	If the NULL test is necessary, the initialization involving a dereference of
	the tested value should be moved after the NULL test.

</pre>
<A HREF=misc_undo/send_m1.cocci>misc_undo/send_m1.cocci</A>  -  Add missing snd_card_free
<pre>
	
	The function snd_mixart_create creates a link between mgr and card that
	allows snd_mixart_free to free card as well.  But if snd_mixart_create
	fails, then the link has not been created and card has to be freed explicitly.

</pre>
<A HREF=misc_undo/send_m2.cocci>misc_undo/send_m2.cocci</A>  -  Add missing snd_card_free
<pre>
	
	The function snd_mixart_create creates a link between mgr and card that
	allows snd_mixart_free to free card as well.  But if snd_mixart_create
	fails, then the link has not been created and card has to be freed explicitly.

</pre>
<A HREF=missing_put/missing_put.cocci>missing_put/missing_put.cocci</A>  -  Add missing of_node_put
<pre>
	
	There should be an of_node_put when breaking out of a loop that iterates
	using for_each_node_by_type.

</pre>
<A HREF=moduleparam/rule5.cocci>moduleparam/rule5.cocci</A>  -  Drop redundant includes of moduleparam.h
<pre>
	
	Drop #include <linux/moduleparam.h> in files that also include #include
	<linux/module.h>.  module.h includes moduleparam.h already.

</pre>
<A HREF=more_of_noput/patch.cocci>more_of_noput/patch.cocci</A>  -  Add missing of_node_put
<pre>
	
	Of_get_parent and of_find_compatible_node do a of_node_get, and thus a
	corresponding of_code_put is needed in both the error case and the normal
	return case.

</pre>
<A HREF=more_pci/get_slot.cocci>more_pci/get_slot.cocci</A>  -  Add missing pci_dev_get
<pre>
	
	pci_get_bus_and_slot does a pci_dev_get, so pci_dev_put needs to be called
	in an error case.

</pre>
<A HREF=more_pci/more_pci.cocci>more_pci/more_pci.cocci</A>  -  Add missing pci_dev_get
<pre>
	
	pci_get_bus_and_slot does a pci_dev_get, so pci_dev_put needs to be called
	in an error case.

</pre>
<A HREF=mutex/mut.cocci>mutex/mut.cocci</A>  -  Release mutex in error handling code
<pre>
	
	The mutex is released on a successful return, so it would seem that it
	should be released on an error return as well.

</pre>
<A HREF=mutex2/mutex2.cocci>mutex2/mutex2.cocci</A>  -  Call mutex_unlock in error handling code
<pre>
	
	Adjust the error handling code so that it benefits from the call to
	mutex_unlock at the end of the function.

</pre>
<A HREF=noderef/noderef.cocci>noderef/noderef.cocci</A>  -  Correct size computation
<pre>
	
	The size argument to kcalloc should be the size of desired structure,
	not the pointer to it.

</pre>
<A HREF=noderef2/noderef2.cocci>noderef2/noderef2.cocci</A>  -  Correct size given to memset
<pre>
	
	Memset should be given the size of the structure, not the size of the pointer.

</pre>
<A HREF=notnull/notnull.cocci>notnull/notnull.cocci</A>  -  Remove redundant test
<pre>
	
	vpage is checked not to be NULL just after it is initialized at the
	beginning of each loop iteration.

</pre>
<A HREF=notnull/notnull2.cocci>notnull/notnull2.cocci</A>  -  Correct redundant test
<pre>
	
	str has already been tested.  It seems that this test should be on the
	recently returned value snr.

</pre>
<A HREF=null_ref/null_ref.cocci>null_ref/null_ref.cocci</A>  -  Move dereference after NULL test
<pre>
	
	If the NULL test on h is needed in snd_harmony_mixer_init, then the
	dereference should be after the NULL test.
	
	Actually, there is a sequence of calls: snd_harmony_create, then
	snd_harmony_pcm_init, and then snd_harmony_mixer_init.  snd_harmony_create
	initializes h, but may indeed leave it as NULL.  There was no NULL test at
	the beginning of snd_harmony_pcm_init, so I have added one.  The NULL test
	in snd_harmony_mixer_init is then not necessary, but in case the ordering
	of the calls changes, I have left it, and moved the dereference after it.

</pre>
<A HREF=null_ref2/mini_null_ref2.cocci>null_ref2/mini_null_ref2.cocci</A>  -  Adjust NULL test
<pre>
	
	Since card must already be non-NULL, it seems that what was intended
	was to test the result of kmalloc.

</pre>
<A HREF=oddpe/oddpe.cocci>oddpe/oddpe.cocci</A>  -  adjust inconsistent IS_ERR and PTR_ERR
<pre>
	
	Change the call to PTR_ERR to access the value just tested by IS_ERR.

</pre>
<A HREF=of_noput/of_noput.cocci>of_noput/of_noput.cocci</A>  -  Add missing of_node_put
<pre>
	
	There should be an of_node_put when breaking out of a loop that iterates
	over calls to of_find_all_nodes, as this function does an of_node_get on
	the value it returns.

</pre>
<A HREF=offset/offset.cocci>offset/offset.cocci</A>  -  Use offsetof
<pre>
	
	In the patch cc154ac64aa8d3396b187f64cef01ce67f433324, Al Viro observed
	that the proper way to compute the distance between two structure fields is
	to use offsetof() or a cast to a pointer to character.  The same change can
	be applied to a few more files.

</pre>
<A HREF=ofiomap/of_iomap-iounmap.cocci>ofiomap/of_iomap-iounmap.cocci</A>  -  Add missing iounmap
<pre>
	
	of_iomap calls ioremap, and so should be matched with an iounmap.  At the
	two error returns, the result of calling of_iomap is only stored in a local
	variable, so these error paths need to call iounmap.  Furthermore, this
	function ultimately stores the result of of_iomap in an array that is local
	to the file.  These values should be iounmapped at some point.  I have
	added a corresponding call to iounmap at the end of the function m8xx_remove.

</pre>
<A HREF=ofnametype/ofname1.cocci>ofnametype/ofname1.cocci</A>  -  Add missing of_node_put
<pre>
	
	of_node_put is needed before discarding a value received from
	of_find_node_by_name, eg in error handling code.

</pre>
<A HREF=ofnametype/oftype1.cocci>ofnametype/oftype1.cocci</A>  -  add missing of_node_put
<pre>
	
	of_node_put is needed before discarding a value received from
	of_find_node_by_name, eg in error handling code.

</pre>
<A HREF=ofnodeget/ofnodeget.cocci>ofnodeget/ofnodeget.cocci</A>  -  Add of_node_put to avoid memory leak
<pre>
	
	Add a call to of_node_put in the error handling code following a call to
	of_find_compatible_node.

</pre>
<A HREF=ofnodeget/ofnodeget1.cocci>ofnodeget/ofnodeget1.cocci</A>  -  Add of_node_put to avoid memory leak
<pre>
	
	Add a call to of_node_put in the error handling code following a call to
	of_find_compatible_node.

</pre>
<A HREF=ofnodeget/ofnodeget2.cocci>ofnodeget/ofnodeget2.cocci</A>  -  Add of_node_put to avoid memory leak
<pre>
	
	Add a call to of_node_put in the error handling code following a call to
	of_find_compatible_node.

</pre>
<A HREF=ofnodeget3/ofnodeget3.cocci>ofnodeget3/ofnodeget3.cocci</A>  -  Add of_node_put to avoid memory leak
<pre>
	
	This function is implemented as though the function of_get_next_child does
	not increment the reference count of its result, but actually it does.
	Thus the patch adds of_node_put in error handling code and drops a call to
	of_node_get.

</pre>
<A HREF=ofnodeget4/ofnodeget4.cocci>ofnodeget4/ofnodeget4.cocci</A>  -  Add of_node_put to avoid memory leak
<pre>
	
	In this case, a device_node structure is stored in another structure that
	is then freed without first decrementing the reference count of the
	device_node structure.

</pre>
<A HREF=ofredef/ofredef.cocci>ofredef/ofredef.cocci</A>  -  Add missing of_node_put
<pre>
	
	np is initialized to the result of calling a function that calls
	of_node_get, so of_node_put should be called before the pointer is dropped.

</pre>
<A HREF=osdi_isnull/osdi_isnull.cocci>osdi_isnull/osdi_isnull.cocci</A>  -  Eliminate a NULL pointer dereference
<pre>
	
	In each case, the print involves dereferencing a value that is NULL or is
	near NULL.

</pre>
<A HREF=osdi_isnull/osdi_isnull3.cocci>osdi_isnull/osdi_isnull3.cocci</A>  -  Eliminate a NULL pointer dereference
<pre>
	
	In each case, the print involves dereferencing a value that is NULL or is
	near NULL.

</pre>
<A HREF=osdi_kfree/osdi_kfree.cocci>osdi_kfree/osdi_kfree.cocci</A>  -  Eliminate use after free
<pre>
	
	The error value is saved in a new local variable err before freeing the
	containing structure.

</pre>
<A HREF=parport/sp8188.cocci>parport/sp8188.cocci</A>  -  Put gotten port value
<pre>
	
	parport_find_number calls parport_get_port on its result, so there should
	be a corresponding call to parport_put_port before dropping the reference.
	Similar code is found in the function register_device in the same file.

</pre>
<A HREF=parse_phandle/parse_phandle.cocci>parse_phandle/parse_phandle.cocci</A>  -  Add missing of_node_put
<pre>
	
	of_parse_phandle increments the reference count of np, so this should be
	decremented before trying the next possibility.

</pre>
<A HREF=pci_add_put/pci_noputm.cocci>pci_add_put/pci_noputm.cocci</A>  -  Add missing pci_dev_put
<pre>
	
	There should be a pci_dev_put when breaking out of a loop that iterates
	over calls to pci_get_device and similar functions.

</pre>
<A HREF=pci_drop_put/pci_get.cocci>pci_drop_put/pci_get.cocci</A>  -  Drop unnecessary pci_dev_put
<pre>
	
	Remove an unnecessary pci_dev_put.  pci_dev_put is called implicitly by the
	subsequent call to pci_get_device.

</pre>
<A HREF=pciom/pciom3.cocci>pciom/pciom3.cocci</A>  -  Exchange pci_iounmaps
<pre>
	
	The calls to pci_iounmap are in the wrong order, as compared to the
	associated calls to pci_iomap.

</pre>
<A HREF=pd/pd.cocci>pd/pd.cocci</A>  -  Invert calls to platform_device_put and platform_device_del
<pre>
	Platform_device_del should be called before platform_device_put, as
	platform_device_put can delete the structure.
	
	Additionally, improve the error handling code for the call to ioremap, so
	that it calls platform_device_put.

</pre>
<A HREF=platret/platret.cocci>platret/platret.cocci</A>  -  failure test for null rather than negative integer
<pre>
	
	dev_get_platdata returns a pointer, so the failure value would be NULL
	rather than a negative integer.

</pre>
<A HREF=pointless_err/pointless_err.cocci>pointless_err/pointless_err.cocci</A>  -  Use ERR_CAST
<pre>
	
	Use ERR_CAST(x) rather than ERR_PTR(PTR_ERR(x)).  The former makes more
	clear what is the purpose of the operation, which otherwise looks like a
	no-op.

</pre>
<A HREF=prepare2/prepare2.cocci>prepare2/prepare2.cocci</A>  -  use clk_prepare_enable and clk_disable_unprepare
<pre>
	
	Clk_prepare_enable and clk_disable_unprepare combine clk_prepare and
	clk_enable, and clk_disable and clk_unprepare.  They make the code more
	concise, and ensure that clk_unprepare is called when clk_enable fails.

</pre>
<A HREF=ptr/ptr.cocci>ptr/ptr.cocci</A>  -  Correct error handling code
<pre>
	
	If it is reasonable to apply PTR_ERR to the result of calling clk_get, then
	that result should first be tested with IS_ERR, not with !.

</pre>
<A HREF=put_after/put_after.cocci>put_after/put_after.cocci</A>  -  Add missing of_node_put
<pre>
	
	dma_channel_np has been accessed at this point, so decrease its reference
	count before leaving the function.

</pre>
<A HREF=put_deref/patch.cocci>put_deref/patch.cocci</A>  -  Move of_node_put
<pre>
	
	It seems better to dereference master before decrementing the reference
	count rather than afterwards.

</pre>
<A HREF=putty/putty.cocci>putty/putty.cocci</A>  -  Avoid calling put_tty_driver on NULL
<pre>
	
	put_tty_driver calls tty_driver_kref_put on its argument, and then
	tty_driver_kref_put calls kref_put on the address of a field of this
	argument.  kref_put checks for NULL, but in this case the field is likely
	to have some offset and so the result of taking its address will not be
	NULL.  Labels are added to be able to skip over the call to put_tty_driver
	when the argument will be NULL.

</pre>
<A HREF=rcu/rcu.cocci>rcu/rcu.cocci</A>  -  Call rcu_read_unlock in default case
<pre>
	
	Adjust the default case so that it benefits from the call to rcu_read_unlock.

</pre>
<A HREF=reiserfs/category2a_open_xa_dir.cocci>reiserfs/category2a_open_xa_dir.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, the function open_xa_dir returns an ERR pointer,
	but never returns a NULL pointer. So a NULL test that comes after an
	IS_ERR test should be deleted.

</pre>
<A HREF=remap_bar/remap_bar.cocci>remap_bar/remap_bar.cocci</A>  -  Reorder error handling code to include iounmap
<pre>
	
	The out_msi_disable label should be before cleanup_nomem to additionally
	benefit from the call to iounmap.  Subsequent gotos are adjusted to go to
	out_msi_disable instead of cleanup_nomem, which now follows it.  This is
	safe because pci_disable_msi does nothing if pci_enable_msi was not called.

</pre>
<A HREF=remove/remove.cocci>remove/remove.cocci</A>  -  Drop return value from platform_driver remove functions
<pre>
	
	The return value of the remove function of a driver structure, and thus of
	a platform_driver structure, is ultimately ignored, and is thus
	unnecessary.  This patch removes the return value for the remove function
	stored in a platform_driver structure.  For the files in this patch, the
	return values are always 0.

</pre>
<A HREF=reqrel2/reqrel2.cocci>reqrel2/reqrel2.cocci</A>  -  Use release_mem_region after request_mem_region
<pre>
	
	The memory allocated using request_mem_region should be released using
	release_mem_region, not release_region.

</pre>
<A HREF=requests/diou.cocci>requests/diou.cocci</A>  -  use devm_kzalloc and devm_clk_get
<pre>
	
	Using devm_kzalloc and devm_clk_get simplifies the code and ensures that
	the use of devm_request_irq is safe.  When kzalloc and kfree were used, the
	interrupt could be triggered after the handler's data argument had been
	freed.

</pre>
<A HREF=requests/dirq.cocci>requests/dirq.cocci</A>  -  use devm_kzalloc and devm_clk_get
<pre>
	
	Using devm_kzalloc and devm_clk_get simplifies the code and ensures that
	the use of devm_request_irq is safe.  When kzalloc and kfree were used, the
	interrupt could be triggered after the handler's data argument had been
	freed.

</pre>
<A HREF=resource/reg.cocci>resource/reg.cocci</A>  -  Convert release_resource to release_region/release_mem_region
<pre>
	
	Request_region should be used with release_region, not release_resource.
	
	The result of request_mem_region is no longer stored.  Instead the field
	ioarea is used to store a pointer to the resource structure that contains
	the start address.  This is the information that is needed later in
	nuc900_i2c_remove to release the region.  The field ioarea is also printed
	in some debugging code.

</pre>
<A HREF=resource/resource.cocci>resource/resource.cocci</A>  -  Convert release_resource to release_region/release_mem_region
<pre>
	
	Request_region should be used with release_region, not release_resource.
	
	The result of request_mem_region is no longer stored.  Instead the field
	ioarea is used to store a pointer to the resource structure that contains
	the start address.  This is the information that is needed later in
	nuc900_i2c_remove to release the region.  The field ioarea is also printed
	in some debugging code.

</pre>
<A HREF=resource_fix1/resource_fix1.cocci>resource_fix1/resource_fix1.cocci</A>  -  Convert release_resource to release_mem_region
<pre>
	
	Request_mem_region should be used with release_mem_region, not
	release_resource.

</pre>
<A HREF=resource_size/resource_size.cocci>resource_size/resource_size.cocci</A>  -  Use resource_size
<pre>
	
	Use the function resource_size, which reduces the chance of introducing
	off-by-one errors in calculating the resource size.

</pre>
<A HREF=ret3/ret3.cocci>ret3/ret3.cocci</A>  -  Fix error return code
<pre>
	
	Convert a nonnegative error return code to a negative one, as returned
	elsewhere in the function.

</pre>
<A HREF=ret4/ret4.cocci>ret4/ret4.cocci</A>  -  Fix error return code
<pre>
	
	Initialize return variable before exiting on an error path.

</pre>
<A HREF=retalloc/retalloc.cocci>retalloc/retalloc.cocci</A>  -  Fix error return code
<pre>
	
	Convert a 0 error return code to a negative one, as returned elsewhere in the
	function.

</pre>
<A HREF=rirqp/rirqp.cocci>rirqp/rirqp.cocci</A>  -  Ensure arguments to request_irq and free_irq are compatible
<pre>
	
	Convert calls to free_irq so that the second argument is the same as the
	last argument of the corresponding call to request_irq.  Without this
	property, free_irq does nothing.

</pre>
<A HREF=round/round.cocci>round/round.cocci</A>  -  Use DIV_ROUND_UP
<pre>
	
	The kernel.h macro DIV_ROUND_UP performs the computation (((n) + (d) - 1) /
	(d)) but is perhaps more readable.

</pre>
<A HREF=round2/round.cocci>round2/round.cocci</A>  -  Use DIV_ROUND_UP
<pre>
	
	The kernel.h macro DIV_ROUND_UP performs the computation (((n) + (d) - 1) /
	(d)) but is perhaps more readable.

</pre>
<A HREF=round_closest/round_closest.cocci>round_closest/round_closest.cocci</A>  -  Use DIV_ROUND_CLOSEST
<pre>
	
	The kernel.h macro DIV_ROUND_CLOSEST performs the computation (x + d/2)/d
	but is perhaps more readable.

</pre>
<A HREF=rr/rr.cocci>rr/rr.cocci</A>  -  Correct use of request_region/request_mem_region
<pre>
	
	request_region should be used with release_region, not request_mem_region.
	
	Geert Uytterhoeven pointed out that in the case of drivers/video/gbefb.c,
	the problem is actually the other way around; request_mem_region should be
	used instead of request_region.

</pre>
<A HREF=rr/rr1.cocci>rr/rr1.cocci</A>  -  Correct use of request_region/request_mem_region
<pre>
	
	request_region should be used with release_region, not request_mem_region.
	
	Geert Uytterhoeven pointed out that in the case of drivers/video/gbefb.c,
	the problem is actually the other way around; request_mem_region should be
	used instead of request_region.

</pre>
<A HREF=rxrpc/category2a_rxrpc_get_transport.cocci>rxrpc/category2a_rxrpc_get_transport.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, the function rxrpc_get_transport returns an ERR
	pointer, but never returns a NULL pointer. So after a call to this
	function, a NULL test should be replaced by an IS_ERR test.

</pre>
<A HREF=s390/category2a_dasd_kmalloc_request.cocci>s390/category2a_dasd_kmalloc_request.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, functions dasd_kmalloc_request and idal_buffer_alloc
	return an ERR pointer, but never return the NULL pointer. So after a
	call to one of these functions, a NULL test should be replaced by an
	IS_ERR test.

</pre>
<A HREF=s390/category2a_idal_buffer_alloc.cocci>s390/category2a_idal_buffer_alloc.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, functions dasd_kmalloc_request and idal_buffer_alloc
	return an ERR pointer, but never return the NULL pointer. So after a
	call to one of these functions, a NULL test should be replaced by an
	IS_ERR test.

</pre>
<A HREF=s390/s390.cocci>s390/s390.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, functions dasd_kmalloc_request and idal_buffer_alloc
	return an ERR pointer, but never return the NULL pointer. So after a
	call to one of these functions, a NULL test should be replaced by an
	IS_ERR test.

</pre>
<A HREF=semicolon/semicolon.cocci>semicolon/semicolon.cocci</A>  -  Remove unnecessary semicolon
<pre>
	
	Removes unnecessary semicolon

</pre>
<A HREF=serial_core/serial_core.cocci>serial_core/serial_core.cocci</A>  -  Use UPIO_MEM rather than SERIAL_IO_MEM
<pre>
	
	As in the commit 9b4a1617772d6d5ab5eeda0cd95302fae119e359, use UPIO_MEM
	rather than SERIAL_IO_MEM.  Both have the same value.

</pre>
<A HREF=signed/signed.cocci>signed/signed.cocci</A>  -  Use unsigned for loop index
<pre>
	
	A few more cases in the spirit of the patch \"Trivial: Replacement of always
	>0 ints with unsigned ints\" submitted by Ricardo Martins <ricardo@scarybox.net>

</pre>
<A HREF=simple_kzalloc/simple_kzalloc1.cocci>simple_kzalloc/simple_kzalloc1.cocci</A>  -  Use kzalloc instead of kmalloc and memset
<pre>
	
	Use kzalloc rather than the combination of kmalloc and memset.

</pre>
<A HREF=sin_family/sin_family.cocci>sin_family/sin_family.cocci</A>  -  Use AF_INET for sin_family field
<pre>
	
	Elsewhere the sin_family field holds a value with a name of the form
	AF_..., so it seems reasonable to do so here as well.  Also the values of
	PF_INET and AF_INET are the same.

</pre>
<A HREF=sizeof/sizeof_sizeof.cocci>sizeof/sizeof_sizeof.cocci</A>  -  Eliminate double sizeof
<pre>
	
	Taking sizeof the result of sizeof is quite strange and does not seem to be
	what is wanted here.

</pre>
<A HREF=sla/sla.cocci>sla/sla.cocci</A>  -  Use GFP_ATOMIC when a lock is held
<pre>
	
	A spin lock is taken near the beginning of the enclosing function.

</pre>
<A HREF=slot/slot.cocci>slot/slot.cocci</A>  -  Add missing pci_dev_put
<pre>
	
	Pci_get_slot calls pci_dev_get, so pci_dev_put is needed before leaving the
	function.

</pre>
<A HREF=soc_sound/category2a_ssc_request.cocci>soc_sound/category2a_ssc_request.cocci</A>  -  Useless NULL test
<pre>
	
	The test (ssc != NULL) can only be reached if the call to the function
	ssc_request, the result of which ssc is assigned, succeeds. Moreover,
	two statements assign NULL to ssc just before a return, which is useless
	since it is a local variable. So, we suggest to delete the test and
	the two assignments.

</pre>
<A HREF=sockfd/patch.cocci>sockfd/patch.cocci</A>  -  Use sockfd_put
<pre>
	
	The function sockfd_lookup uses fget on the value that is stored in the
	file field of the returned structure, so fput should ultimately be applied
	to this value.  This can be done directly, but it seems better to use the
	sockfd specific macro sockfd_put, which does the same thing.

</pre>
<A HREF=stest/stest.cocci>stest/stest.cocci</A>  -  Put NULL test before dereference
<pre>
	
	If the NULL test on block is needed, it should be before the dereference of
	the base field.

</pre>
<A HREF=strsize/strsizeof.cocci>strsize/strsizeof.cocci</A>  -  Convert strncmp to strcmp
<pre>
	
	As an identical match is wanted in this case, strcmp can be used instead.

</pre>
<A HREF=strtoul/simple.cocci>strtoul/simple.cocci</A>  -  Change simple_strtol to simple_strtoul
<pre>
	
	Since bridge is unsigned, it would seem better to use simple_strtoul that
	simple_strtol.

</pre>
<A HREF=sz/sz.cocci>sz/sz.cocci</A>  -  Correct code taking the size of a pointer
<pre>
	
	sizeof(share_id) is just the size of the pointer.  On the other hand,
	block->share_id is an array, so its size seems more appropriate.

</pre>
<A HREF=sz3/sz3.cocci>sz3/sz3.cocci</A>  -  Take size of pointed value, not pointer
<pre>
	
	Sizeof a pointer-typed expression returns the size of the pointer, not that
	of the pointed data.

</pre>
<A HREF=tipc/tipc.cocci>tipc/tipc.cocci</A>  -  Use tipc_port_unlock
<pre>
	
	The file net/tipc/port.c takes a lock using the function tipc_port_lock and
	then releases the lock sometimes using tipc_port_unlock and sometimes using
	spin_unlock_bh(p_ptr->publ.lock).  tipc_port_unlock simply does the
	spin_unlock_bh, but it seems cleaner to use it everywhere.

</pre>
<A HREF=tty_port/sp10730.cocci>tty_port/sp10730.cocci</A>  -  Put correct tty value
<pre>
	
	The tty value that should be put is the one that was just gotten by
	tty_port_tty_get, not the one that is the argument to the enclosing
	function.

</pre>
<A HREF=typedef/handle.cocci>typedef/handle.cocci</A>  -  Transform typedef HANDLE into void *
<pre>
	
	Remove typedef HANDLE which aliases a void pointer and use void *
	anywhere HANDLE was used.

</pre>
<A HREF=typedef/hv/device_object/DEVICE_OBJECT.cocci>typedef/hv/device_object/DEVICE_OBJECT.cocci</A>  -  Transform PDEVICE_OBJECT and DEVICE_OBJECT typedefs into their corresponding structs
<pre>
	
	Remove typedef DEVICE_OBJECT and use a struct named hv_device instead.
	
	Remove typedef PDEVICE_OBJECT which aliases a pointer and use the
	struct pointer (struct hv_device *).

</pre>
<A HREF=typedef/hv/driver_object/DRIVER_OBJECT.cocci>typedef/hv/driver_object/DRIVER_OBJECT.cocci</A>  -  Remove typedef DRIVER_OBJECT and PDRIVER_OBJECT
<pre>
	
	typedef DRIVER_OBJECT and PDRIVER_OBJECT are removed and their usages
	are replace by the use of struct hv_driver and struct hv_driver *
	respectively.

</pre>
<A HREF=typedef/hv/netvsc/NETVSC_PACKET.cocci>typedef/hv/netvsc/NETVSC_PACKET.cocci</A>  -  Remove typedef NETVSC_PACKET and PNETVSC_PACKET
<pre>
	
	typedef NETVSC_PACKET and PNETVSC_PACKET are removed and their usages
	are replace by the use of struct hv_netvsc_packet and
	struct hv_netvsc_packet * respectively.

</pre>
<A HREF=typedef/hv/storvsc/STORVSC_REQUEST.cocci>typedef/hv/storvsc/STORVSC_REQUEST.cocci</A>  -  Remove typedef STORVSC_REQUEST and PSTORVSC_REQUEST
<pre>
	
	typedef STORVSC_REQUEST and PSTORVSC_REQUEST are removed and their
	usages are replace by the use of struct hv_storvsc_request and
	struct hv_storvsc_request * respectively.

</pre>
<A HREF=ubi/category2b_add_volume.cocci>ubi/category2b_add_volume.cocci</A>  -  Bad IS_ERR test
<pre>
	
	In case of error, the function add_volume returns an ERR pointer. The
	result of IS_ERR, which is supposed to be used in a test as it is, is
	here checked to be less than zero, which seems odd. We suggest to
	replace this test by a simple IS_ERR test.

</pre>
<A HREF=ubifs/category2a_kthread_create.cocci>ubifs/category2a_kthread_create.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, the function kthread_create returns an ERR pointer,
	but never returns a NULL pointer. So a NULL test that comes before an
	IS_ERR test should be deleted.

</pre>
<A HREF=ulfe/ulfe.cocci>ulfe/ulfe.cocci</A>  -  Use list_for_each_entry
<pre>
	
	Use list_for_each_entry and perform some other induced simplifications.

</pre>
<A HREF=undevm/undevm.cocci>undevm/undevm.cocci</A>  -  Kfree etc should not be used with devm functions
<pre>
	
	Using kfree with devm_kzalloc will cause a double free, and likewise for
	the other devm functions.

</pre>
<A HREF=unsf/unsf.cocci>unsf/unsf.cocci</A>  -  Fix return value from an unsigned function
<pre>
	
	The function has an unsigned return type, but returns a negative constant
	to indicate an error condition.  

</pre>
<A HREF=unsf/unsf_ret0.cocci>unsf/unsf_ret0.cocci</A>  -  Fix return value from an unsigned function
<pre>
	
	The function has an unsigned return type, but returns a negative constant
	to indicate an error condition.  Another error condition in the same
	function is indicated by returning 0, and indeed the only call to the
	function checks for 0 to detect errors, so the return of a negative value
	it converted to a return of 0.

</pre>
<A HREF=unused/unused.cocci>unused/unused.cocci</A>  -  Remove unused variable
<pre>
	
	Remove unused variable

</pre>
<A HREF=unused_err/unused_err.cocci>unused_err/unused_err.cocci</A>  -  Use available error codes
<pre>
	
	Error codes are stored in err, but the return value is always 0.  Return
	err instead.

</pre>
<A HREF=unused_var_kfree/unused_var_kfree.cocci>unused_var_kfree/unused_var_kfree.cocci</A>  -  Remove two unused variables and two useless calls to kfree
<pre>
	old_class_name, and new_class_name are never used. This patch remove the
	declaration and calls to kfree.
	
	The semantic match that finds this problem is as follows:
	(http://coccinelle.lip6.fr/)
	
	// <smpl>
	@r1 forall@
	type T; identifier i;
	@@
	* T *i = NULL;
	  ... when != i
	* kfree(i);
	// </smpl>
	
	Signed-off-by: Peter Senna Tschudin <peter.senna@gmail.com>

</pre>
<A HREF=urb2/urb2.cocci>urb2/urb2.cocci</A>  -  Delete unnecessary call to usb_kill_urb
<pre>
	
	Since in each case nothing has been done with the recently allocated urb,
	it is not necessary to kill it before freeing it.

</pre>
<A HREF=urb8/urb8.cocci>urb8/urb8.cocci</A>  -  Introduce missing usb_free_urb
<pre>
	
	Error handling code following a usb_alloc_urb should free the allocated data.

</pre>
<A HREF=usb/category2a_back_device_reg.cocci>usb/category2a_back_device_reg.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, the function backlight_device_register returns an
	ERR pointer, but never returns a NULL pointer. So a NULL test that may
	come after a call to this function should be strengthened by an IS_ERR
	test.

</pre>
<A HREF=usb/category2a_isp1760_reg.cocci>usb/category2a_isp1760_reg.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, the function isp1760_register returns an ERR
	pointer, but never returns a NULL pointer. So after a call to this
	function, a NULL test should be replaced by an IS_ERR test. Moreover,
	we have noticed that:
	(1) the result of isp1760_register is assigned through the function
	pci_set_drvdata without an error test,
	(2) if the call to isp1760_register fails, the current function
	(isp1761_pci_probe) returns 0, and if it succeeds, it returns -ENOMEM,
	which seems odd.
	
	Thus, we suggest to move the test before the call to pci_set_drvdata
	to correct (1), and to turn it into a non IS_ERR test to correct (2).

</pre>
<A HREF=usbdata/usb_get_intfdata.cocci>usbdata/usb_get_intfdata.cocci</A>  -  Use usb_set/get_intfdata
<pre>
	
	Use the USB functions usb_get_intfdata and usb_set_intfdata instead of
	dev_get_drvdata and dev_set_drvdata, respectively.

</pre>
<A HREF=usbdata/usb_set_intfdata.cocci>usbdata/usb_set_intfdata.cocci</A>  -  Use usb_set/get_intfdata
<pre>
	
	Use the USB functions usb_get_intfdata and usb_set_intfdata instead of
	dev_get_drvdata and dev_set_drvdata, respectively.

</pre>
<A HREF=usbdir/end.cocci>usbdir/end.cocci</A>  -  Use usb_endpoint_dir_out
<pre>
	
	Use the usb_endpoint_dir_out API function.  Note that the use of
	USB_TYPE_MASK in the original code is incorrect; it results in a test that
	is always false.

</pre>
<A HREF=use_freed_specific/bad_kfree.cocci>use_freed_specific/bad_kfree.cocci</A>  -  Eliminate use after free
<pre>
	
	__sa1111_remove always frees its argument, so the subsequent reference to
	sachip->saved_state represents a use after free.  __sa1111_remove does not
	appear to use the saved_state field, so the patch simply frees it first.

</pre>
<A HREF=usefreed/bad_kfree.cocci>usefreed/bad_kfree.cocci</A>  -  Correct use after free
<pre>
	
	Move the kfree after a reference to the freed structure.

</pre>
<A HREF=uselesskfree/uselesskfree.cocci>uselesskfree/uselesskfree.cocci</A>  -  Remove useless kfree
<pre>
	
	Remove useless kfree() and clean up code related to the removal.

</pre>
<A HREF=video/patch.cocci>video/patch.cocci</A>  -  Use video_device_release rather than kfree
<pre>
	
	The file drivers/media/video/videodev.c defines both video_device_alloc and
	video_device_release.  These are essentially just kzmalloc and kfree,
	respectively, but it seems better to use video_device_release, as done in
	the other media files, rather than kfree, in case the implementation some
	day changes.

</pre>
<A HREF=videobuf_dvb_get_frontend_return_null/videobuf_dvb_get_frontend_return_null.cocci>videobuf_dvb_get_frontend_return_null/videobuf_dvb_get_frontend_return_null.cocci</A>  -  Test if videobuf_dvb_get_frontend return NULL
<pre>
	
	Based on commit: e66131cee501ee720b7b58a4b87073b8fbaaaba6
	Not testing videobuf_dvb_get_frontend output may cause OOPS if it return
	NULL. This patch fixes this issue.

</pre>
<A HREF=warn/warn.cocci>warn/warn.cocci</A>  -  Use WARN
<pre>
	
	Use WARN rather than printk followed by WARN_ON(1), for conciseness.

</pre>
<A HREF=warn2/warn2.cocci>warn2/warn2.cocci</A>  -  Drop if around WARN_ON
<pre>
	
	Just use WARN_ON rather than an if containing only WARN_ON(1).

</pre>
<A HREF=write2/write2.cocci>write2/write2.cocci</A>  -  delete double assignment
<pre>
	
	Delete successive assignments to the same location.

</pre>
<A HREF=wrongtest/wrongtest.cocci>wrongtest/wrongtest.cocci</A>  -  Test the just-initialized value
<pre>
	
	Test the just-initialized value rather than some other one.

</pre>
<A HREF=x25/patch.cocci>x25/patch.cocci</A>  -  Add missing x25_neigh_put
<pre>
	
	The function x25_get_neigh increments a reference count.  At the point of
	the second goto out, the result of calling x25_get_neigh is only stored in
	a local variable, and thus no one outside the function will be able to
	decrease the reference count.  Thus, x25_neigh_put should be called before
	the return in this case.

</pre>
<A HREF=xand/xand.cocci>xand/xand.cocci</A>  -  Detect duplicated test
<pre>
	
	Look for duplicate && and || tests.

</pre>
<A HREF=xfrm/category2a_xfrm_bundle_create.cocci>xfrm/category2a_xfrm_bundle_create.cocci</A>  -  Use an IS_ERR test rather than a NULL test
<pre>
	
	In case of error, the function xfrm_bundle_create returns an ERR
	pointer, but never returns a NULL pointer. So a NULL test that comes
	after an IS_ERR test should be deleted.

</pre>
<A HREF=zercst/zercst.cocci>zercst/zercst.cocci</A>  -  Adjust suspicious bit operation
<pre>
	
	IRQF_TRIGGER_HIGH is 0x00000004, so it seems that & was intended rather than |.

</pre>
<A HREF=zero/rezero.cocci>zero/rezero.cocci</A>  -  Possible problem with V4L2_TUNER_MODE_MONO
<pre>
	
	The file drivers/media/video/tvaudio.c contains the following code:
	
	(starting at line 1257 in a recent linux-next)
	
	                if (mode & V4L2_TUNER_MODE_MONO)
	                        s1 |= TDA8425_S1_STEREO_MONO;
	                if (mode & V4L2_TUNER_MODE_STEREO)
	                        s1 |= TDA8425_S1_STEREO_SPATIAL;
	
	(starting at line 1856 in a recent linux-next)
	
	        if (mode & V4L2_TUNER_MODE_MONO)
	                vt->rxsubchans |= V4L2_TUNER_SUB_MONO;
	        if (mode & V4L2_TUNER_MODE_STEREO)
	                vt->rxsubchans |= V4L2_TUNER_SUB_STEREO;
	
	The only possible value of V4L2_TUNER_MODE_MONO, however, seems to be 0, as
	defined in include/linux/videodev2.h, and thus the first test in each case
	is never true.  Is this what is intended, or should the tests be expressed
	in another way?

</pre>
<P>
<HR>
Target: Samba
<P>
<A HREF=samba_free/samba.cocci>samba_free/samba.cocci</A>  -  Add missing calls to talloc_free
<pre>
	
	There seem to be a number of places in the samba code where calls to
	talloc_free are omitted.  This patch fixes some cases.

</pre>
</body></html>
